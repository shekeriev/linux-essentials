# Упражнения с Debian/openSUSE/Red Hat*

\* *Можете да използвате произволна дистрибуция, която е част от някоя от трите фамилии. Повечето команди ще работят и на други дистрибуции.*

С помощта на упражненията в този документ трябва да придобием и затвърдим базови умения за работа с файлове и папки в конзолен режим. В допълнение, ще видим как можем да се информираме за мрежовите настройки на нашата машина и как да работим със софтуерни пакети.

## Съдържание

* [Ориентиране в конзолата](#1-ориентиране-в-конзолата)

* [Изследване на файловата система](#2-изследване-на-файловата-система)

* [Разглеждане на текстови файлове](#3-разглеждане-на-текстови-файлове)

* [Работа с папки и файлове](#4-работа-с-папки-и-файлове)

* [Работа с текстови файлове](#5-работа-с-текстови-файлове)

* [Изследване на мрежата](#6-изследване-на-мрежата)

* [Работа със софтуерни пакети](#7-работа-със-софтуерни-пакети)

* [Работа с потребители и групи](#8-работа-с-потребители-и-групи)

* [Управление на права](#9-управление-на-права)

## 1. Ориентиране в конзолата

Важна част от процеса на ориентиране в конзолата в възможността да разберем с какви инструменти разполагаме и как да ги използваме. Трябва да можем да се ориентираме кои команди са вградени и кои външни. Необходимо е също така да можем бързо, удобно и лесно да получаваме информация за това какво прави всяка команда и как се използва. Всичко изброено можем да постигнем с помощта на командите **help** и **man**.

### Задача 1.1

Разберете кои са достъпните вградени команди.

Решение:

Вариант 1:*

```bash
$ help
```

Вариант 2*:

```bash
$ man builtin
```

### Задача 1.2

Изберете три вградени команди и получете повече информация за това как се използват.

Решение:

Вариант 1:

```bash
$ help cd
...
$ help pwd
...
$ help time
```

Вариант 2*:

```bash
$ man cd
...
$ man pwd
...
$ man time
```

### Задача 1.3

Ако знаем, че командата **echo** е вградена, то нека да проверим как се използва и след това, с нейна помощ, да отпечатаме нашето име.

Решение:

Вариант 1:

```bash
$ help echo
...
$ echo Ivan Petrov
```

Вариант 2*:

```bash
$ man echo
...
$ echo Ivan Petrov
```

### Задача 1.4

Ако знаем, че командата **ls** е външна, то как можем да видим какви параметри приема на командния ред?

Решение:

Вариант 1:

```bash
$ ls --help
```

Вариант 2*:

```bash
$ man ls
```

## 2. Изследване на файловата система

Определено не е необходимо да помним всеки детайл за файловата структура, но е добре да можем да се придвижваме и ориантираме в нея. Тук на помощ идват командите за отпечатване на текущата директория (**pwd**), за смяна на текущата директория (**cd**) и за преглед на съдържанието на текущата или избрана директория (**ls**).

По подразбиране командата **ls** извежда кратък списък, само с имената, на стандартните файлове и папки без скритите (имената им започват с .) такива. Разбира се, с помощта на допълнителни модификатори, можем да управляваме какво и как да бъде включено в списъка. В допълнение, бихме могли да използваме и специални символи и похвати, за управляване на резултата.

### Задача 2.1

Разберете в коя папка се намирате в момента.

Решение:

```bash
$ pwd
```

### Задача 2.2

Сменете текущата папка с папката **/etc**. В тази папка се съхраняват системни конфигурационни файлове.

Решение:

```bash
$ cd /etc
...
$ pwd
```

### Задача 2.3

Разгледайте съдържанието на папка **/etc**. След това изведете подробен списък на файловете с разширение **conf**. Най-накрая изведете подробен списък на всички файлове в папката без тези, които се намират в нейните под-папки, но нека размера на файловете да е в човеко-четим вид.

Решение:

```bash
$ ls
...
$ ls -l *.conf
...
$ ls -lh
```

### Задача 2.4

Нека да отидем в папка **/bin** и да разгледаме в детайли нейното съдържание. В тази папка се намират често използвани външни команди.

Решение:

```bash
$ cd /bin
...
$ pwd
...
$ ls -l
```

### Задача 2.5

Нека да отидем в нашата домашна папка и да изведем детайлен списък с всички файлове, включително и скритите.

Решение:

Вариант 1:

```bash
$ cd ~
...
$ pwd
...
$ ls -al
```

Вариант 2:

```bash
$ cd
...
$ pwd
...
$ ls -al
```

## 3. Разглеждане на текстови файлове

Текстовите файлове заемат изключително важно място във всяка една Linux система. Основна причина за това е, че настройките на системата и приложенията се съхраняват именно в такива файлове. В допълнение, те се използват и за съхранение на журнални и диагностични съобщения.

Малка част от инструментите, с които разполагаме:

* **cat** - показва цялото съдържание на файл в прав ред
* **tac** - показва цялото съдържание на файл в обратен ред
* **more** - разглеждане на съдържанието на файл екран по екран
* **less** - разглеждане на съдържанието на файл екран по екран
* **head** - показва само първите X реда (по подразбиране 10) от файл
* **tail** - показва само последните X реда (по подразбиране 10) от фйал

### Задача 3.1

Разгледайте съдържанието на файла **/etc/passwd**. Това е файлът, съдържащ всички локални потребители, дефинирани в нашата система.

Решение:

```bash
$ cat /etc/passwd
```

### Задача 3.2

Изведете съдържанието на файла **/etc/passwd** в обратен ред.

Решение:

```bash
$ tac /etc/passwd
```

### Задача 3.3

Разгледайте съдържанието на файла **/etc/services**. В този файл са описани мрежовите услуги и използваните от тях протокол и порт.

Решение:

Вариант 1:

```bash
$ more /etc/services
```

Вариант 2:

```bash
$ less /etc/services
```

### Задача 3.4

Отворете файла **/etc/services** с помощта на програмата **less**. След това натиснете клавиша **h**, за да се покаже екрана с помощна информация. Открийте как да търсите и да се придвижвате в отворения файл. Отидете в неговия край и започнете обратно търсене на стринга **dns**. Преминете през всички съвпадения и след това излезте от файла.

Решение:

```bash
$ less /etc/passwd
...
Натиснете клавиша h
...
Излезте от помощния екран с клавиша q
...
Натиснете клавиша G
...
След това въведете ? dns
...
Натиснете няколко пъти клавиша n
...
Затворете файла като натиснете q
```

### Задача 3.5

Нека да изведем първите четири реда на файла **/etc/group**. В този файл се съхраняват потребителските групи, дефинирани на системата.

Решение:

```bash
$ head -n 4 /etc/group
```

### Задача 3.6

Нека да изведем последните два реда на файла **/etc/group**.

Решение:

```bash
$ tail -n 2 /etc/group
```

## 4. Работа с папки и файлове

Създаването и управлението на файлове е неразделна част от процеса на работа с една система. С нарастването на броя на файловете, в един момент възниква необходимост от организирането им в папки.

Част от инструментите, с които разполагаме са:

* **mkdir** - за създаване на папки
* **rmdir** - за изтриване на празни папки
* **cp** - за копиране на файлове и папки
* **mv** - за преименуване или преместване на файлове и папки
* **rm** - за изтриване на файлове и папки
* **file** - за изследване на файлове
* **stat** - за получаване на информация за времето на създаване, промяна и отваряне на файл
* **touch** - за създаване на празен файл или промяна на времето на промяна или отваряне на файл
* **tree** - за извежане на йерархия от папки *(може да липсва, виж по-долу как се инсталира)*

### Задача 4.1

Нека да се върнем в нашата домашна папка и да създадем папка с името **workshop**.

Решение:

```bash
$ cd
...
$ mkdir workshop
```

### Задача 4.2

Влезте в папката **workshop** във вашата домашна папка и създайте две нови папки - **test-1** и **test-2**.

Решение:

Вариант 1:

```bash
$ cd workshop
...
$ mkdir test-1
...
$ mkdir test-2
```

Вариант 2:

```bash
$ cd workshop
...
$ mkdir test-1 test-2
```

Вариант 3:

```bash
$ cd workshop
...
$ mkdir test-{1..2}
```

### Задача 4.3

В папката **workshop** създайте група от папки - **dir-1**, **dir-2**, **dir-3** и **dir-4**, като във всяка папка трябва да има по две под-папки с имена **docs** и **sources**.

Решение:

```bash
$ cd workshop
...
$ mkdir -p dir-{1..4}/{docs,sources}
```

### Задача 4.4

Визуализирайте съдържанието на папка **workshop** по най-подходящия начин.

Решение:

```bash
$ cd
...
$ tree workshop
```

### Задача 4.5

Изтрийте папки **test-1** и **test-2**.

Решение:

Вариант 1:

```bash
$ rmdir test-1<br />...<br />$ rmdir test-2
```

Вариант 2:

```bash
$ rmdir test-1 test-2
```

Вариант 3:

```bash
$ rmdir test-*
```

### Задача 4.6

Използвайте командата **touch** и създайте 100 празни файла с име **file-xxx**, където **xxx** е число от 1 до 100.

Решение:

```bash
$ touch file-{1..100}
```

### Задача 4.7

Прегледайте времевите данни на папка **dir-1** и сменете времето ѝ на последен дотъп. След това направете повторна проверка на времената.

Решение:

```bash
$ stat dir-1<br />...<br />$ touch -a dir-1<br />...<br />$ stat dir-1</pre>
```

### Задача 4.8

Копирайте всички файлове, които създадохте по-рано в папка **dir-1**.

Решение:

```bash
$ cp file-* dir-1
```

### Задача 4.9

Преместете всички файлове, които създадохте по-рано в папка **dir-2**.

Решение:

```bash
$ mv file-* dir-2
```

### Задача 4.10

Създайте нова папка **dir-5** и копирайте в нея цялото съдържание (файлове и папки) от папка **dir-1**.

Решение:

```bash
$ mkdir dir-5
...
$ cp -r dir-1/* dir-5
```

### Задача 4.11

Изтрийте всички папки, чието име започва с **dir-**.

Решение:

Вариант 1:

```bash
$ rm -r dir-1 dir-2 dir-3 dir-4 dir-5
```

Вариант 2:

```bash
$ rm -r dir-*
```

## 5. Работа с текстови файлове

Освен да консумираме съдържанието на текстовите файлове, често ще ни се налага и да ги създаваме и/или да им променяме съдържанието. Има различни варианти и инструменти за изпълнение на тези дейности.

Малка част от наличните команди са:

* **nano** - опростен текстови редактор
* **cut** - за изтриване на празни папки
* **sort** - за копиране на файлове и папки
* **uniq** - за преименуване или преместване на файлове и папки
* **join** - за изтриване на файлове и папки

Файлове могат да се създават и "в движение" с помощта на методите за пренасочване на потока - **>** и **>>**.

Нови файлове могат да се създават и чрез последователната обработка на поток от данни с помощта на няколко команди. Придвижването на потока става като между всеки две команди поставим символа **|**.

### Задача 5.1

В папката **workshop**, използвайки техниките за пренасочване създайте файл **people.txt**, който съдържа имената на поне трима души (име и фамилия), но не по азбучен ред и нека едната фамилия да се повтаря. След това изведете съдържанието на файла на екран.

Решение:

```bash
$ echo "Ivan Ivanov" > people.txt
...
$ echo "Angel Hristov" >> people.txt
...
$ echo "Tsvetan Ivanov" >> people.txt
...
$ cat people.txt
```

### Задача 5.2

Сортирайте съдържанието на файла **people.txt** по азбучен ред и го изведете на екран.

Решение:

Вариант 1:

```bash
$ cat people.txt | sort
```

Вариант 2:

```bash
$ sort people.txt
```

### Задача 5.3

Изведете на екран списък с личните имена от файла **people.txt**.

Решение:

```bash
$ cut -d ' ' -f 1 people.txt
```

### Задача 5.4

Изведете на екран списък с уникалните фамилни имена от файла **people.txt**.

Решение:

```bash
$ cut -d ' ' -f 2 people.txt | sort | uniq
```

### Задача 5.5

С помощта на текстовия редактор **nano** създайте два тесктови файла **f1.txt** и **f2.txt** съответно със съдържание:

| **f1.txt** | **f2.txt** |
-------------|-------------
| 1:Bulgaria | 1:Sofia    |
| 2:Romania  | 2:Bucharest|
| 3:Greece   | 3:Athens   |

Решение:

```bash
$ nano f1.txt
...
Ctrl+o
...
Ctrl+x
...
$ nano f2.txt
...
Ctrl+o
...
Ctrl+x
...
$ cat f1.txt f2.txt
```

### Задача 5.6

С помощта на командата **join** създайте нов файл **combined.txt**, който обединява файловете **f1.txt** и **f2.txt**

Решение:

```bash
$ join -t : -j 1 f1.txt f2.txt > combined.txt
...
$ cat combined.txt
```

## 6. Изследване на мрежата

Често ще ни се налага да се информираме за състоянието на нашата мрежова свързаност, както по отношение на това какви са текущите ни настройки, така и дали имаме успешна връзка до определн съвър в локалната мрежа и/или в Интернет. Част от командите, с които ще ни се налага да работим са:

* **ip** - за изследване и промяна на текущата конфигурация на мрежата
* **ping** - за проверка за наличие на мрежова свързаност до машина в мрежата
* **host** - за проверка на съответствие между адрес и име

Добре е също така да познаваме и поне следните файлове:

* **/etc/resolv.conf** - съдържа настройки за процеса по намиране на съответствие между име и адрес
* **/etc/hosts** - играе ролята на локален източник на съответствия между име и адрес

### Задача 6.1

Проверете какви са текущите ви мрежови настройки. Намерете мрежовия адрес и маската.

Решение:

```bash
$ ip a
```

### Задача 6.2

Проверете дали достигате успешно популярен адрес в Интернет, примерно **8.8.8.8**

Решение:

```bash
$ ping -c 4 8.8.8.8
...
64 bytes from 8.8.8.8: icmp_seq=2 ttl=119 time=5.55 ms
...
```

### Задача 6.3

Проверете дали достигате успешно популярен адрес в Интернет, примерно **kernel.org**

Решение:

```bash
$ ping -c 4 kernel.org
...
64 bytes from dfw.source.kernel.org (139.178.84.217): icmp_seq=2 ttl=49 time=151 ms
...
```

### Задача 6.4

Проверете какъв е IP адресът, съответстващ на популярен адрес в Интернет, примерно на **lpi.org**

Решение:

```bash
$ host lpi.org
...
lpi.org has address 65.39.134.147
...
```

### Задача 6.5

Прегледайте съдържанието на файловете **/etc/resolv.conf** и **/etc/hosts**

Решение:

```bash
$ cat /etc/resolv.conf
...
$ cat /etc/hosts
...
```

## 7. Работа със софтуерни пакети

Управлението на софтуерните пакети е неразделна част от ежедневната ни работа в Linux среда. Тук имаме сравнително голямо многообразие от инструменти и пакетни формати, като всяка дистрибуция може да използва различна комбинация.

Някои от популярните пакетни формати и инструменти за работа с тях са:

* **rpm** - пакетен формат, използван от дистрибуции като Fedora, Red Hat, openSUSE, PCLinuxOS и др.
* **deb** - пакетен формат, използван от дистрибуции като Debian, Ubuntu, Linux Mint и др.
* **rpm** - команда за работа с локални RPM пакети
* **dpkg** - команда за работа с локални DEB пакети
* **apt** - команда за работа с DEB пакети и отдалечени хранилища
* **dnf** - команда за работа с RPM пакети и отдалечени хранилища (среща се в дистрибуции от Red Hat фамилията)
* **zypper** - команда за работа с RPM пакети и отдалечени хранилища (среща се в openSUSE и SUSE дистрибуциите)

### Задача 7.1

Проверете какви отдалечени хранилища на пакети има регистрирани във вашата система.

Решение:

***Debian фамилия***

*Тук няма "лесен" начин, т.е. няма вградена команда. Вместо това, можем да прегледаме съдържанието на файла и папката, в които се добавят хранилищата:*

```bash
$ grep ^[^#] /etc/apt/sources.list /etc/apt/sources.list.d/*
```

*Можем и ръчно да разгледаме съдържанието на съответния файл и папка:*

```bash
$ cat /etc/apt/sources.list
...
$ ls -al /etc/apt/sources.list.d/
```

***openSUSE фамилия***

*Можем да използваме zypper:*

```bash
$ zypper repos
...
$ zypper lr
```

*Можем и ръчно да разгледаме съдържанието на съответната папка:*

```bash
$ ls -al /etc/zypp/repos.d/
```

***Red Hat фамилия***

*Само активните хранилища:*

```bash
$ dnf repolist
```

*Всички регистрирани хранилища:*

```bash
$ dnf repolist --all
```

*Или ръчно разглеждане на съдържанието на съответната папка:*

```bash
$ ls -al /etc/yum/repos.d/
```

### Задача 7.2

Проверете какви пакети има инсталирани във вашата система.

Решение:

***Debian фамилия***

*Използвайки dpkg или dpkg-query:*

```bash
$ dpkg --list
...
$ dpkg-query --list
```

*Използвайки apt:*

```bash
apt list --installed
```

***openSUSE фамилия***

*Използвайки rpm:*

```bash
$ rpm -qa
```

*Използвайки zypper:*

```bash
$ zypper packages --installed-only
```

***Red Hat фамилия***

*Използвайки rpm:*

```bash
$ rpm -qa
```

*Използвайки dnf:*

```bash
$ dnf list --installed
```

### Задача 7.3

Инсталирайте няколко пакета (примерно lynx и tree) като използвате командите, специфични за вашата система.

Решение:

***Debian фамилия***

```bash
$ sudo apt update
...
$ sudo apt install lynx tree
```

***openSUSE фамилия***

```bash
$ sudo zypper install lynx tree
```

***Red Hat фамилия***

```bash
$ sudo dnf install lynx tree
```

*Ако работите с root, то няма нужда да поставяте sudo пред командите.*

### Допълнителна задача

Посетете [този]("https://repos.zahariev.pro/") адрес и следвайте инструкциите за вашата система, за да инсталирате хранилище и пакет.

## 8. Работа с потребители и групи

Управлението на потребителите и групите е сред важните дейности по управлението на нашите Linux-базирани системи.

Някои от основните команди в тази връзка са:

* **useradd** - команда за създаване на потребител
* **usermod** - команда за промяна на потребител
* **userdel** - команда за ризтриване на потребител
* **groupadd** - команда за добавене на група
* **groupmod** - команда за промяна на група
* **groupdel** - команда за изтриване на група
* **passwd** - команда за смяна на паролата на потребител

### Задача 8.1

Създайте потребителски акаунт john с пълно име John Smith и му задайте парола.

Решение:

Потребителският акаунт можем да създадем така:

```bash
useradd -m -c 'John Smith' john
```

А след това, можем да назначим парола с тази команда:

```bash
passwd john
```

*Ако не работите с root, то ще трябва използвате sudo пред командите.*

### Задача 8.2

Създайте група с име team.

Решение:

Група можем да създадем с:

```bash
groupadd team
```

*Ако не работите с root, то ще трябва използвате sudo пред командите.*

### Задача 8.3

Направете john член на групата team.

Решение:

Това може да бъде постигнато чрез:

```bash
usermod -aG team john
```

*Ако не работите с root, то ще трябва използвате sudo пред командите.*

## 9. Управление на права

Управлението на достъпа до файловете и папките на нашите Linux-базирани системи е от ключово значение.

Някои от основните команди в тази връзка са:

* **chmod** - команда за промяна на правата върху файл или папка
* **chown** - команда за промяна на собствеността (потребител или група) върху файл или папка
* **chgrp** - команда за промяна на групата собственик на файл или папка

### Задача 9.1

Създайте папка /data и направете john и team собственици.

Решение:

Самата папка можем да създадем така:

```bash
mkdir /data
```

След това, можем да сменим собствеността така:

```bash
chown john:team /data
```

*(1) Ако не работите с root, то ще трябва използвате sudo пред командите.*

*(2) Символът : (двуеточие) може да бъде заменен и със символа . (точка).*

*(3) Ако искаме да сменим собствеността не само върху папката, а и върху всичко под нея, то трябва да добавим -R опция към командата.*

### Задача 9.2

Задайте правата върху /data така, че собственика да може да прави всичко, групата собственик да има права за четене и изпълнение, а всички останали да нямат никакви права.

Решение:

Ако изберем числовата (осмичната) нотация, можем да изпълним следната команда:

```bash
chmod 750 /data
```

Ако изберем символната нотация, можем да изпълним следната команда:

```bash
chmod u=rwx,g=rx,o= /data
```

*(1) Ако не работите с root, то ще трябва използвате sudo пред командите.*

*(2) Ако искаме да сменим правата не само върху папката, а и върху всичко под нея, то трябва да добавим -R опция към командата.*
